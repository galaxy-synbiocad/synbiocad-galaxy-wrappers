<tool id="rpScorer" name="Score Pathway">
  <description>Calculate the global score based on thermodynamics, FBA, length, and reaction rule scores of heterologous pathway</description>
  <requirements>
    <requirement type="package">rptools</requirement>
  </requirements>
  <stdio>
		<regex match="WARNING" level="warning" />
		<regex match="ERROR" level="error" />
	</stdio>
  <command detect_errors="exit_code"><![CDATA[
    python -m rptools.rpscore
      '$input'
      --outfile '$output'
      --weight_rp_steps   '$adv.weight_rp_steps'
      --weight_rule_score '$adv.weight_rule_score'
      --weight_fba        '$adv.weight_fba'
      --weight_thermo     '$adv.weight_thermo'
      --fba_ceil          '$adv.fba_ceil'
      --fba_floor         '$adv.fba_floor'
      --thermo_ceil       '$adv.thermo_ceil'
      --thermo_floor      '$adv.thermo_floor'
      --max_rp_steps      '$max_rp_steps'
      --pathway_id        '$adv.pathway_id'
      --objective_id      '$adv.objective_id'
      --thermo_id         '$adv.thermo_id'
  ]]></command>
  <inputs>
		<!-- <conditional name="input_type">
			<param name="input_format" type="select" label="Input/output format:">
				<option value="tar" selected="True">TAR</option>
				<option value="sbml" >SBML</option>
			</param>
			<when value="tar">
				<param name="input" type="data" format="tar" label="Input file" />
			</when>
			<when value="sbml">
				<param name="input" type="data" format="sbml" label="Input file" />
			</when>
		</conditional> -->
		<param name="input" type="data" format="xml" label="Input file" />
    <param name="max_rp_steps" type="integer" value="15" label="Maximal number of steps (as ran in RetroPath2.0)" />
    <section name="adv" title="Advanced Options" expanded="false">
      <param name="fba_ceil" value="5.0" type="float" label="FBA ceiling" />
      <param name="fba_floor" value="0.0" type="float" label="FBA floor" />
      <param name="thermo_ceil" value="8901.2" type="float" label="Thermodynamics ceiling" />
      <param name="thermo_floor" value="-7570.2" type="float" label="Thermodynamics floor" />
      <param name="pathway_id" type="text" value="rp_pathway" label="SBML heterologous pathway ID" />
      <param name="objective_id" type="text" value="obj_fraction" label="Heterologous pathway objective ID" />
      <param name="thermo_id" type="text" value="dfG_prime_m" label="Thermodynamics ID" />
      <param name="weight_rule_score" value="0.1246" type="float" label="Reaction rule weight" />
      <param name="weight_fba" value="0.324" type="float" label="FBA weight" />
      <param name="weight_thermo" value="0.544" type="float" label="Thermodynamics weight" />
      <param name="weight_rp_steps" value="0.073" type="float" label="Steps weight" />
    </section>
  </inputs>
  <outputs>
    <data name="output" format="xml" label="${tool.name} - ${input.name}" >
      <!-- <change_format>
        <when input="format_type.input_format" value="sbml" format="sbml"/>
      </change_format> -->
    </data>
  </outputs>
  <help><![CDATA[
Score Pathway
=============

After performing FBA, thermodynamic analysis on the heterologous pathways generated by Retropath2.0 this tool normalizes the different values from each heterologous pathway, and performs a weighted sum function using the following attributes:
	  
	  - Length of the heterologous pathways
	  - Flux to the target compound
	  - Thermodynamic feasibility of the heterologous pathway
	  - Sum of the reaction rule scores
	  

Input
-----

Required:


* **-input**\ : (string) Path to rpSBML file.
* **-max_rp_steps**\ : (integer) Maximal number of steps as previously ran in RetroPath2.-

Advanced options:


* **-fba_ceil**\ : (float, default=3.0) FBA ceiling
* **-fba_floor**\ : (float, default=0.0) FBA floor
* **-thermo_ceil**\ : (float, default=8901.2) Thermodynamics ceiling
* **-thermo_floor**\ : (float, default=-7570.2) Thermodynamics floor
* **-weight_rp_steps**\ : (float, default=0.0) Number of steps weight
* **-max_rp_steps**\ : (integer, default=15) Maximal number of steps (as run in RetroPath2.0)
* **-weight_rule_score**\ : (float, default=0.0) Reation rule score weight
* **-weight_fba**\ : (float, default=0.699707) FBA weight
* **-weight_thermo**\ : (float, default=0.8334961) Pathway thermodynamics weight
* **-pathway_id**\ : (string, default=rp_pathway) Name of the heterologous pathway
* **-objective_id**\ : (string, default=obj_RP1_sink__restricted_biomass) Name of the heterologous pathway objective function
* **-thermo_id**\ : (string, default=dfG_prime_m) Name of the thermodynamics

Output
------


* **output**\ : (string) Path to the output file

Project Links
---------------------

* `GitHub <https://github.com/Galaxy-SynBioCAD/rpGlobalScore>`_

Version
----------

0.1

Authors
-------


* **Melchior du Lac**

License
-------

`MIT <https://raw.githubusercontent.com/Galaxy-SynBioCAD/rpGlobalScore/local/LICENSE>`_

Acknowledgments
---------------


* Thomas Duigou
* Joan HÃ©risson

]]></help>
</tool>
